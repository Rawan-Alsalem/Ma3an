<!-- backOffice/templates/backOffice/edit_subscription.html -->
{% extends 'backOffice/base.html' %}
{% block title %}Edit Subscription{% endblock %}

{% block content %}

<div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-4">
  <div>
    <div class="page-title h3 mb-1">Edit Subscription</div>
    <div class="text-muted">{{ sub.agency.agency_name }}</div>
  </div>
  <a class="btn btn-outline-light" href="{% url 'backOffice:manage_subscriptions' %}">
    <i class="bi bi-arrow-left me-1"></i> Back
  </a>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    <div class="p-3 rounded border mb-3" style="border-color: rgba(255,255,255,.08) !important;">
      <div class="text-muted small">Agency</div>
      <div class="fw-semibold">{{ sub.agency.agency_name }}</div>
      <div class="text-muted small">{{ sub.agency.user.username }} Â· {{ sub.agency.user.email }}</div>
    </div>

    <form method="post" class="row g-3">
      {% csrf_token %}

      <div class="col-12 col-lg-6">
        <label class="form-label">Plan</label>
        <select class="form-select" name="plan_id">
          {% for p in plans %}
            <option value="{{ p.id }}" {% if p.id == sub.plan.id %}selected{% endif %}>
              {{ p.subscriptionType }} ({{ p.price }})
            </option>
          {% endfor %}
        </select>
      </div>

      <div class="col-12 col-lg-6">
        <label class="form-label">Status</label>
        <select class="form-select" name="status">
          {% for value, label in status_choices %}
            <option value="{{ value }}" {% if value == sub.status %}selected{% endif %}>
              {{ label }}
            </option>
          {% endfor %}
        </select>
      </div>

      <div class="col-12 col-lg-6">
        <label class="form-label">Expiry date</label>
        <input class="form-control" type="date" name="expiry_date" value="{{ sub.expiry_date|date:'Y-m-d' }}">
      </div>

      <div class="col-12 d-flex gap-2">
        <button class="btn btn-primary" type="submit"><i class="bi bi-save me-1"></i> Save changes</button>
        <a class="btn btn-outline-light" href="{% url 'backOffice:manage_subscriptions' %}">Cancel</a>
      </div>
    </form>
  </div>
</div>

{% endblock %}
